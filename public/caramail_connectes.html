<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>CaraMail — Connecté(e)s</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    *{box-sizing:border-box}
    html,body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#e6e6e6;color:#111}
    a{color:#0047cc;text-decoration:underline}
    .wrap{min-height:100vh;display:flex;flex-direction:column}
    /* Tabs */
    .topbar{background:#cfcfcf;border-bottom:1px solid #9c9c9c;display:flex;align-items:flex-end;gap:8px;flex-wrap:wrap;padding:6px 10px}
    .tabs{display:flex;gap:6px;flex-wrap:wrap;align-items:flex-end;position:relative}
    .tabs:after{content:"";position:absolute;left:0;right:0;bottom:-1px;height:1px;background:#b5b5b5}
    .tab{background:#e9e9e9;padding:6px 10px;border-top:1px solid #fff;border-left:1px solid #fff;border-right:1px solid #8f8f8f;border-bottom:1px solid #8f8f8f;border-radius:4px 4px 0 0;font-weight:700;white-space:nowrap}
    .tab.active{background:#fff;border-bottom-color:#fff}
    .tab.active .tab-label{color:#0047cc;text-decoration:underline}
    .status{margin-left:auto;padding-bottom:6px;font-size:12px;color:#333;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:50%}
    /* Content */
    .container{max-width:1080px;margin:0 auto;padding:16px}
    h1{font-size:20px;margin:8px 0 14px}
    .grid{display:grid;grid-template-columns:2fr 1fr;gap:14px}
    @media(max-width:900px){ .grid{grid-template-columns:1fr} .status{flex-basis:100%;max-width:100%} }
    .card{background:#fff;border:1px solid #dfe3ec;border-radius:10px;padding:14px;box-shadow:0 12px 36px rgba(0,0,0,.06)}
    .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    .input,.select{padding:10px;border:1px solid #cfd7e6;border-radius:8px;font-size:15px}
    .input{min-width:0;flex:1}
    .btn{padding:10px 14px;border:none;border-radius:8px;background:#0066cc;color:#fff;font-weight:800;cursor:pointer}
    .list{margin-top:8px;border-top:1px dashed #cfd7e6}
    .row{display:grid;grid-template-columns:1fr 110px 210px;gap:10px;align-items:center;padding:10px 0;border-bottom:1px dashed #edf0f6}
    .nick{font-weight:800;overflow-wrap:anywhere}
    .badge{display:inline-block;padding:4px 8px;border:1px solid #dfe3ec;border-radius:999px;background:#f7f9ff;font-size:12px;margin-right:6px}
    .online{background:#e6f8ea;border-color:#c4e9ce;color:#146b2e}
    .busy{background:#fff3e1;border-color:#ffd9a6;color:#8a5000}
    .invisible{background:#eef1f6;border-color:#dfe3ec;color:#556}
    .actions{display:flex;gap:8px;flex-wrap:wrap}
    .ghost{background:#efefef;color:#111;border:1px solid #c7ccd6}
    @media(max-width:760px){ .row{grid-template-columns:1fr} .actions .btn{width:100%} }
    footer{margin-top:auto;border-top:1px solid #dcdcdc;background:#f3f3f3}
    .foot{max-width:1080px;margin:0 auto;padding:12px;color:#555;font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="tabs" aria-label="Onglets">
        <div class="tab"><span class="tab-label">Salons</span></div>
        <div class="tab active"><span class="tab-label">Connecté(e)s</span></div>
        <div class="tab"><span class="tab-label">Options</span></div>
        <div class="tab"><span class="tab-label">Ami(e)s</span></div>
        <div class="tab"><span class="tab-label">Mon compte</span></div>
      </div>
      <div class="status">Connecté en tant que <strong>moi@caramail.com</strong></div>
    </div>

    <main class="container">
      <h1>Utilisateurs connectés</h1>
      <div class="grid">
        <section class="card">
          <div class="toolbar">
            <input id="q" class="input" placeholder="Rechercher un pseudo, ex: caranormandie">
            <select id="state" class="select">
              <option value="all">Tous les statuts</option>
              <option value="online">En ligne</option>
              <option value="busy">Occupé(e)</option>
              <option value="invisible">Invisible</option>
            </select>
            <select id="room" class="select">
              <option value="all">Tous les salons</option>
              <option value="#cafe-des-modes">#cafe-des-modes</option>
              <option value="#nostalgie-2002">#nostalgie-2002</option>
              <option value="#entraide-web">#entraide-web</option>
            </select>
            <button class="btn" id="reset">Réinitialiser</button>
          </div>

          <div id="list" class="list"></div>
        </section>

        <aside>
          <section class="card">
            <h2 style="margin:0 0 8px">Actions groupées</h2>
            <button class="btn" id="addAll">Ajouter à mes ami(e)s (sélection)</button>
            <button class="btn ghost" id="ignoreAll" style="margin-top:8px">Ignorer (sélection)</button>
            <p style="font-size:12px;color:#5a6a8e;margin-top:8px">Astuce : cochez plusieurs personnes dans la liste pour appliquer une action groupée.</p>
          </section>
        </aside>
      </div>
    </main>

    <footer>
      <div class="foot">© 2025 CaraMail — <a href="#">Mentions légales</a> · <a href="#">Confidentialité</a> · <a href="#">Cookies</a></div>
    </footer>
  </div>

  <script>
    const data = [
      {nick:'caranormandie', state:'online', room:'#cafe-des-modes'},
      {nick:'#Hades', state:'busy', room:'#cafe-des-modes'},
      {nick:'mike-caen', state:'online', room:'#caen'},
      {nick:'o0.c.y.b.e.r..t.r.a.c.k.0o', state:'invisible', room:'#nostalgie-2002'},
      {nick:'guest_42', state:'online', room:'#entraide-web'}
    ];

    const listEl = document.getElementById('list');
    const qEl = document.getElementById('q');
    const stateEl = document.getElementById('state');
    const roomEl = document.getElementById('room');
    const resetBtn = document.getElementById('reset');

    function badge(state){
      const map = {online:'online', busy:'busy', invisible:'invisible'};
      return `<span class="badge ${map[state]}">${state}</span>`;
    }

    function render(){
      const q = (qEl.value||'').toLowerCase();
      const st = stateEl.value;
      const rm = roomEl.value;
      const filtered = data.filter(u => {
        const matchQ = !q || u.nick.toLowerCase().includes(q);
        const matchS = st==='all' || u.state===st;
        const matchR = rm==='all' || u.room===rm;
        return matchQ && matchS && matchR;
      });
      listEl.innerHTML = '';
      filtered.forEach((u, idx) => {
        const row = document.createElement('div');
        row.className = 'row';
        row.innerHTML = `
          <div><label><input type="checkbox" data-idx="${idx}"> <span class="nick">${u.nick}</span></label><div class="badge">${u.room}</div></div>
          <div>${badge(u.state)}</div>
          <div class="actions">
            <button class="btn">PV</button>
            <button class="btn ghost">Ignorer</button>
            <button class="btn">Ajouter ami(e)</button>
          </div>
        `;
        row.querySelectorAll('.btn')[0].addEventListener('click', () => alert('Ouvrir PV avec '+u.nick+' (démo)'));
        row.querySelectorAll('.btn')[1].addEventListener('click', () => alert('Ignorer '+u.nick+' (démo)'));
        row.querySelectorAll('.btn')[2].addEventListener('click', () => alert('Ajouté(e) : '+u.nick+' (démo)'));
        listEl.appendChild(row);
      });
    }

    qEl.addEventListener('input', render);
    stateEl.addEventListener('change', render);
    roomEl.addEventListener('change', render);
    resetBtn.addEventListener('click', () => { qEl.value=''; stateEl.value='all'; roomEl.value='all'; render(); });

    document.getElementById('addAll').addEventListener('click', () => {
      const sel = [...document.querySelectorAll('input[type="checkbox"]:checked')].map(cb => data[cb.dataset.idx].nick);
      alert('Ajout en amis (démo): ' + (sel.join(', ') || 'aucune sélection'));
    });
    document.getElementById('ignoreAll').addEventListener('click', () => {
      const sel = [...document.querySelectorAll('input[type="checkbox"]:checked')].map(cb => data[cb.dataset.idx].nick);
      alert('Ignorés (démo): ' + (sel.join(', ') || 'aucune sélection'));
    });

    render();
  </script>
  <script src="/caramail_nav.js"></script>
</body>
</html>
